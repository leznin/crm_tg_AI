# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: OpenRouter Integration

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. **API –∫–ª—é—á OpenRouter** - –ø–æ–ª—É—á–∏—Ç–µ –Ω–∞ [openrouter.ai](https://openrouter.ai)
2. **MySQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ –¥–æ—Å—Ç—É–ø–Ω–∞
3. **Python 3.8+** - —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ —Å–∏—Å—Ç–µ–º–µ

## –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
cd backend
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

## –®–∞–≥ 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ OpenRouter API

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤–∞—à API –∫–ª—é—á
export OPENROUTER_API_KEY="sk-or-v1-–≤–∞—à-–∫–ª—é—á-–∑–¥–µ—Å—å"

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç
python test_openrouter.py
```

–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:
```
üöÄ OpenRouter Integration Test
==================================================
üîë API –∫–ª—é—á –Ω–∞–π–¥–µ–Ω
üß™ –ù–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å OpenRouter...

1Ô∏è‚É£ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...
   ‚úÖ Connection successful

2Ô∏è‚É£ –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –∞–∫–∫–∞—É–Ω—Ç–∞...
   üí∞ –ë–∞–ª–∞–Ω—Å: $25.50
   üìä –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ: $4.50

3Ô∏è‚É£ –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π...
   üìù –¢–µ–∫—Å—Ç–æ–≤—ã–µ –º–æ–¥–µ–ª–∏: 15
      ‚Ä¢ GPT-4 Turbo (OpenAI)
      ‚Ä¢ Claude 3 Opus (Anthropic)
      ‚Ä¢ Gemini Pro (Google)
   üñºÔ∏è  –ú–æ–¥–µ–ª–∏ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: 5
   üéµ –ú–æ–¥–µ–ª–∏ –¥–ª—è –∞—É–¥–∏–æ: 3

4Ô∏è‚É£ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞...
   ü§ñ –ò—Å–ø–æ–ª—å–∑—É–µ–º –º–æ–¥–µ–ª—å: openai/gpt-3.5-turbo
   üí¨ –û—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏: –ü—Ä–∏–≤–µ—Ç! –£ –º–µ–Ω—è –≤—Å—ë –æ—Ç–ª–∏—á–Ω–æ, —Å–ø–∞—Å–∏–±–æ!

‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ!
```

## –®–∞–≥ 3: –ó–∞–ø—É—Å–∫ backend —Å–µ—Ä–≤–µ—Ä–∞

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ
source venv/bin/activate

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

## –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏**
3. –ù–∞ –≤–∫–ª–∞–¥–∫–µ **"API –∫–ª—é—á–∏"** –¥–æ–±–∞–≤—å—Ç–µ –≤–∞—à OpenRouter API –∫–ª—é—á
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"AI –ú–æ–¥–µ–ª–∏"**
5. –ù–∞–∂–º–∏—Ç–µ **"–û–±–Ω–æ–≤–∏—Ç—å"** –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
6. –í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞:
   - **–¢–µ–∫—Å—Ç**: –Ω–∞–ø—Ä–∏–º–µ—Ä, `openai/gpt-3.5-turbo`
   - **–ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (Vision)**: –Ω–∞–ø—Ä–∏–º–µ—Ä, `openai/gpt-4-vision-preview`
   - **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**: –Ω–∞–ø—Ä–∏–º–µ—Ä, `openai/dall-e-3`
   - **–ê—É–¥–∏–æ**: –Ω–∞–ø—Ä–∏–º–µ—Ä, `openai/whisper-1`

## –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ß–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:
- –ù–∞–∂–º–∏—Ç–µ **"–ë–∞–ª–∞–Ω—Å"** –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–µ–∫—É—â–µ–≥–æ –±–∞–ª–∞–Ω—Å–∞
- –ú–æ–¥–µ–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ

### –ß–µ—Ä–µ–∑ API:
```bash
# –ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –º–æ–¥–µ–ª–∏
curl -X GET "http://localhost:8000/api/v1/settings/openrouter/models" \
     -H "Content-Type: application/json" \
     --cookie "session=–≤–∞—à–∞-—Å–µ—Å—Å–∏—è"

# –ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å
curl -X GET "http://localhost:8000/api/v1/settings/openrouter/balance" \
     -H "Content-Type: application/json" \
     --cookie "session=–≤–∞—à–∞-—Å–µ—Å—Å–∏—è"

# –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
curl -X POST "http://localhost:8000/api/v1/settings/openrouter/test-connection" \
     -H "Content-Type: application/json" \
     --cookie "session=–≤–∞—à–∞-—Å–µ—Å—Å–∏—è"
```

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### ‚ùå "API key not configured"
**–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ API –∫–ª—é—á –¥–æ–±–∞–≤–ª–µ–Ω –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω

### ‚ùå "Rate limit exceeded"
**–†–µ—à–µ–Ω–∏–µ**: –ü–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç, OpenRouter –∏–º–µ–µ—Ç –ª–∏–º–∏—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### ‚ùå "Invalid API key"
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å API –∫–ª—é—á–∞ –Ω–∞ [openrouter.ai](https://openrouter.ai)

### ‚ùå "Network error"
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å openrouter.ai

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
backend/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ openrouter_service.py    # üÜï –°–µ—Ä–≤–∏—Å OpenRouter
‚îÇ   ‚îú‚îÄ‚îÄ api/v1/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ settings_router.py       # ‚úèÔ∏è –û–±–Ω–æ–≤–ª–µ–Ω —Å –Ω–æ–≤—ã–º–∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ settings_service.py      # ‚úèÔ∏è –î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã OpenRouter
‚îÇ   ‚îî‚îÄ‚îÄ schemas/
‚îÇ       ‚îî‚îÄ‚îÄ settings_schema.py       # ‚úèÔ∏è –ù–æ–≤—ã–µ —Å—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ test_openrouter.py               # üÜï –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
‚îî‚îÄ‚îÄ OPENROUTER_INTEGRATION.md        # üÜï –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

```
frontend/
‚îî‚îÄ‚îÄ src/
    ‚îî‚îÄ‚îÄ components/
        ‚îî‚îÄ‚îÄ Settings.tsx             # ‚úèÔ∏è –ù–æ–≤–∞—è –≤–∫–ª–∞–¥–∫–∞ "AI –ú–æ–¥–µ–ª–∏"
```

## API Endpoints

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/api/v1/settings/openrouter/models` | –ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –º–æ–¥–µ–ª–∏ |
| GET | `/api/v1/settings/openrouter/balance` | –ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å –∞–∫–∫–∞—É–Ω—Ç–∞ |
| POST | `/api/v1/settings/openrouter/test-connection` | –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è |
| POST | `/api/v1/settings/models` | –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –º–æ–¥–µ–ª—å |
| GET | `/api/v1/settings/models` | –ü–æ–ª—É—á–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ |

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚úÖ **API –∫–ª—é—á–∏ —à–∏—Ñ—Ä—É—é—Ç—Å—è** –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö  
‚úÖ **–ú–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ** –∫–ª—é—á–µ–π –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ  
‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** —á–µ—Ä–µ–∑ Pydantic —Å—Ö–µ–º—ã  
‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** –∏ rate limiting  

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `test_openrouter.py` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
3. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å openrouter.ai

---

üéâ **–ì–æ—Ç–æ–≤–æ!** –í–∞—à–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenRouter –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!
